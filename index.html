<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¥“ä¹‹è°·BOSSé‡ç”Ÿæ™‚é–“ç³»çµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #0a0a1a 0%, #15152b 100%);
            color: #e2e8f0;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(21, 21, 43, 0.5);
            border-radius: 15px;
            border: 1px solid rgba(0, 153, 204, 0.3);
        }

        .header h1 {
            color: #0099cc;
            font-size: 2em;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(0, 153, 204, 0.3);
        }

        .header p {
            color: #66ddee;
            font-size: 1.1em;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(0, 153, 204, 0.3);
            flex-wrap: nowrap;
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }

        .tabs::-webkit-scrollbar {
            height: 4px;
        }

        .tabs::-webkit-scrollbar-thumb {
            background: rgba(0, 153, 204, 0.5);
            border-radius: 2px;
        }

        .tab {
            padding: 12px 24px;
            background: #1e1e3a;
            border: 1px solid rgba(0, 153, 204, 0.3);
            border-bottom: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            color: #94a3b8;
            transition: all 0.3s;
            flex-shrink: 0;
        }

        .tab:hover {
            background: #2a2a4a;
            color: #cbd5e1;
        }

        .tab.active {
            background: #0099cc;
            color: #0a0a1a;
            font-weight: bold;
        }

        .tab-content {
            display: none;
            background: #15152b;
            padding: 25px;
            border-radius: 10px;
            border: 1px solid #00ccff;
        }

        .tab-content.active {
            display: block;
        }

        .section {
            background: rgba(30, 41, 59, 0.6);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid rgba(100, 116, 139, 0.3);
        }

        .section h2 {
            color: #0099cc;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .input-field {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .map-select-wrapper {
            background: rgba(0, 153, 204, 0.1);
            padding: 15px;
            border-radius: 8px;
            border: 2px solid rgba(0, 153, 204, 0.3);
            margin: 15px 0;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .map-select-wrapper label {
            color: #0099cc;
            font-size: 1em;
            font-weight: bold;
            margin-bottom: 8px;
            display: block;
        }

        .map-select-wrapper select {
            width: 100%;
            font-size: 1.05em;
            padding: 12px;
        }

        label {
            color: #a0a0c0;
            font-size: 0.9em;
        }

        select, input[type="text"], input[type="number"] {
            padding: 10px;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(100, 116, 139, 0.4);
            border-radius: 5px;
            color: #e2e8f0;
            font-size: 1em;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #0099cc;
            box-shadow: 0 0 0 2px rgba(0, 153, 204, 0.2);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .boss-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: #00ccff;
        }

        .info-box {
            background: rgba(0, 153, 204, 0.1);
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #0099cc;
        }

        .info-box p {
            color: #66ddee;
            margin: 5px 0;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        button {
            padding: 12px 24px;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(100, 116, 139, 0.4);
            border-radius: 5px;
            color: #e2e8f0;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
        }

        button:hover {
            background: #0099cc;
            color: #0a0a1a;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 153, 204, 0.3);
            border-color: #0099cc;
        }

        button:active {
            transform: translateY(0);
        }

        button.danger {
            border-color: rgba(239, 68, 68, 0.4);
            color: #fca5a5;
        }

        button.danger:hover {
            background: #ef4444;
            color: #ffffff;
            border-color: #ef4444;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #2a2a4a;
        }

        th {
            background: #0a0a1a;
            color: #00ccff;
            font-weight: bold;
            position: sticky;
            top: 0;
        }

        tr:hover {
            background: rgba(0, 204, 255, 0.1);
        }

        tr.selected {
            background: rgba(0, 204, 255, 0.2);
        }

        .status-waiting {
            color: #a0a0c0;
        }

        .status-possible {
            color: #ff9800;
            font-weight: bold;
        }

        .status-definite {
            color: #ff3366;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .status-display {
            background: #0a0a1a;
            padding: 20px;
            border-radius: 10px;
            max-height: 600px;
            overflow-y: auto;
            font-family: 'Consolas', monospace;
        }

        .boss-status-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.95) 0%, rgba(15, 23, 42, 0.95) 100%);
            padding: 16px 20px;
            border-radius: 12px;
            margin-bottom: 16px;
            border: 1px solid rgba(100, 116, 139, 0.3);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .boss-status-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, rgba(0, 153, 204, 0.3) 0%, rgba(102, 221, 238, 0.3) 50%, rgba(0, 153, 204, 0.3) 100%);
            background-size: 200% 100%;
            animation: borderGlow 3s ease infinite;
        }

        .boss-status-card::after {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--boss-color, #0099cc);
            border-radius: 12px 0 0 12px;
        }

        @keyframes borderGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .boss-status-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 153, 204, 0.15);
            border-color: rgba(0, 153, 204, 0.4);
        }

        .boss-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: nowrap;
            gap: 20px;
        }

        .boss-info-left {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
            min-width: 0;
        }

        .boss-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #fbbf24;
            box-shadow: 0 0 10px #fbbf24;
            flex-shrink: 0;
            animation: pulseIndicator 2s ease-in-out infinite;
        }

        @keyframes pulseIndicator {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        .boss-name-section {
            flex: 1;
            min-width: 0;
        }

        .boss-name-main {
            color: #ffffff;
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .boss-channel {
            color: #94a3b8;
            font-size: 0.9em;
        }

        .boss-info-row {
            display: flex;
            align-items: center;
            gap: 16px;
            color: #cbd5e1;
            font-size: 1.2em;
            flex-wrap: wrap;
        }

        .boss-info-item {
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }

        .countdown-badge {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: #ffffff;
            padding: 12px 20px;
            border-radius: 10px;
            font-weight: 700;
            font-size: 1.1em;
            white-space: nowrap;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
            min-width: 120px;
            text-align: center;
            line-height: 1.4;
        }

        .countdown-badge .status-text {
            font-size: 0.75em;
            font-weight: 500;
            opacity: 0.9;
            display: block;
            margin-bottom: 2px;
        }

        .countdown-badge .time-text {
            font-size: 1.3em;
            font-weight: 700;
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
        }

        .countdown-badge.in-window {
            background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
            animation: blinkBadge 1.5s ease-in-out infinite;
            box-shadow: 0 4px 12px rgba(249, 115, 22, 0.4);
        }

        @keyframes blinkBadge {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.85; }
        }

        .countdown-badge.expired {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            box-shadow: 0 4px 12px rgba(220, 38, 38, 0.4);
        }

        .boss-status-badge {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.9em;
            font-weight: 600;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .boss-status-badge.waiting {
            background: rgba(59, 130, 246, 0.2);
            color: #60a5fa;
        }

        .boss-status-badge.possible {
            background: rgba(249, 115, 22, 0.2);
            color: #fb923c;
        }

        .boss-status-badge.confirmed {
            background: rgba(220, 38, 38, 0.2);
            color: #f87171;
        }

        .boss-action-btns {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-shrink: 0;
        }

        .boss-icon-btn {
            width: 36px;
            height: 36px;
            padding: 0;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(100, 116, 139, 0.3);
            border-radius: 6px;
            color: #cbd5e1;
            cursor: pointer;
            font-size: 1.2em;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .boss-icon-btn:hover {
            background: rgba(51, 65, 85, 0.8);
            border-color: rgba(100, 116, 139, 0.5);
            transform: translateY(-1px);
        }

        .boss-icon-btn.delete {
            background: rgba(220, 38, 38, 0.1);
            border-color: rgba(220, 38, 38, 0.3);
            color: #fca5a5;
        }

        .boss-icon-btn.delete:hover {
            background: rgba(220, 38, 38, 0.2);
            border-color: rgba(220, 38, 38, 0.5);
        }

        .quick-input-row {
            display: grid;
            grid-template-columns: 2fr 1fr auto;
            gap: 15px;
            align-items: end;
        }

        .quick-input-row .input-field {
            margin: 0;
        }

        .quick-input-row button {
            padding: 12px 32px;
            height: fit-content;
            font-size: 1.05em;
            font-weight: 600;
        }

        .boss-action-btn {
            flex: 1;
            padding: 8px 12px;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(100, 116, 139, 0.3);
            border-radius: 6px;
            color: #cbd5e1;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.2s;
        }

        .boss-action-btn:hover {
            background: rgba(51, 65, 85, 0.8);
            border-color: rgba(100, 116, 139, 0.5);
            transform: translateY(-1px);
        }

        .boss-action-btn.delete {
            background: rgba(220, 38, 38, 0.1);
            border-color: rgba(220, 38, 38, 0.3);
            color: #fca5a5;
        }

        .boss-action-btn.delete:hover {
            background: rgba(220, 38, 38, 0.2);
            border-color: rgba(220, 38, 38, 0.5);
        }

        .boss-status-card h3 {
            color: #00ccff;
            margin-bottom: 10px;
        }

        .boss-status-card p {
            margin: 5px 0;
            color: #a0a0c0;
        }

        /* BOSS åœ–ç‰‡æ¨£å¼ */
        .boss-image {
            width: 50px;
            height: 50px;
            object-fit: contain;
            flex-shrink: 0;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .boss-image-large {
            width: 80px;
            height: 80px;
            object-fit: contain;
            filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.4));
        }

        .boss-select-preview {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
            padding: 10px;
            background: rgba(0, 153, 204, 0.1);
            border-radius: 8px;
        }

        .boss-select-preview img {
            width: 60px;
            height: 60px;
            object-fit: contain;
        }

        .stats-card-image {
            width: 45px;
            height: 45px;
            object-fit: contain;
            margin-right: 10px;
        }

        .boss-list-image {
            width: 40px;
            height: 40px;
            object-fit: contain;
            vertical-align: middle;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #1e1e3a;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #00ccff;
            max-width: 400px;
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        @keyframes slideIn {
            from {
                transform: translateX(500px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification.success {
            border-color: rgba(16, 185, 129, 0.5);
        }

        .notification.error {
            border-color: rgba(239, 68, 68, 0.5);
        }

        .notification.warning {
            border-color: rgba(245, 158, 11, 0.5);
        }

        .scrollbar::-webkit-scrollbar {
            width: 10px;
        }

        .scrollbar::-webkit-scrollbar-track {
            background: #0a0a1a;
        }

        .scrollbar::-webkit-scrollbar-thumb {
            background: #00ccff;
            border-radius: 5px;
        }

        .scrollbar::-webkit-scrollbar-thumb:hover {
            background: #00ff99;
        }

        .current-time {
            text-align: center;
            font-size: 1.2em;
            color: #00ff99;
            margin-bottom: 20px;
            padding: 10px;
            background: rgba(0, 255, 153, 0.1);
            border-radius: 5px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .hint {
            color: #00ff99;
            font-size: 0.9em;
            margin-top: 10px;
            font-style: italic;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stats-card {
            background: #1e1e3a;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #00ccff;
            transition: all 0.3s;
        }

        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 204, 255, 0.3);
        }

        .stats-card h3 {
            color: #00ccff;
            margin-bottom: 15px;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stats-number {
            font-size: 2em;
            font-weight: bold;
            margin: 10px 0;
        }

        .stats-label {
            color: #a0a0c0;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .stats-total {
            color: #00ff99;
        }

        .stats-today {
            color: #ff9800;
        }

        .stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        @media (max-width: 768px) {
            .input-group {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 1.5em;
            }

            table {
                font-size: 0.85em;
            }

            th, td {
                padding: 8px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .quick-input-row {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .quick-input-row button {
                width: 100%;
            }

            .boss-card-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .boss-info-left {
                width: 100%;
            }

            .boss-info-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .countdown-badge {
                width: 100%;
            }

            .boss-action-btns {
                width: 100%;
                justify-content: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ® æ¥“ä¹‹è°·BOSSé‡ç”Ÿæ™‚é–“ç³»çµ±</h1>
            <p>å¯¦æ™‚ç›£æ§èˆ‡æé†’</p>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab(0)">BOSSè¨˜éŒ„</div>
            <div class="tab" onclick="switchTab(1)">BOSSåˆ—è¡¨</div>
            <div class="tab" onclick="switchTab(2)">æ“Šæ®ºçµ±è¨ˆ</div>
            <div class="tab" onclick="switchTab(3)">æ”¹å–„å»ºè­°</div>
        </div>

        <div class="tab-content active" id="tab-record">
            <div class="section">
                <h2>å¿«é€Ÿè¨˜éŒ„ BOSS æ“Šæ®º</h2>
                <div class="quick-input-row">
                    <div class="input-field">
                        <label>é¸æ“‡BOSS:</label>
                        <select id="boss-select" onchange="onBossSelected()">
                            <option value="">è«‹é¸æ“‡...</option>
                        </select>
                    </div>
                    <div class="input-field">
                        <label>é »é“:</label>
                        <input type="number" id="channel-input" value="1" min="1" max="20">
                    </div>
                    <button onclick="recordBoss()" style="background: linear-gradient(135deg, #0099cc 0%, #0077aa 100%); border-color: #0099cc;">
                        ğŸ“ è¨˜éŒ„æ“Šæ®º
                    </button>
                </div>

                <div class="map-select-wrapper" id="map-select-container" style="display: none;">
                    <label>ğŸ—ºï¸ é¸æ“‡åœ°åœ–ä½ç½®:</label>
                    <select id="map-select">
                        <option value="7">å¤œå¸‚å¾’æ­¥å€7</option>
                        <option value="7-1">å¤œå¸‚å¾’æ­¥å€7-1</option>
                    </select>
                </div>

                <div class="info-box" id="boss-info" style="display: none;">
                    <div class="boss-select-preview">
                        <img id="boss-preview-image" src="" alt="BOSSé è¦½" style="display: none;">
                        <div>
                            <p id="map-info"></p>
                            <p id="time-info"></p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 style="margin: 0;">ç•¶å‰è¨˜éŒ„ä¸­çš„BOSS (<span id="boss-count">0</span>)</h2>
                    <button onclick="clearAll()" class="danger" style="margin: 0;">âš ï¸ æ¸…ç©ºæ‰€æœ‰è¨˜éŒ„</button>
                </div>
                <div id="record-container" style="display: grid; gap: 16px;">
                    <!-- å¡ç‰‡å°‡é€šéJavaScriptå‹•æ…‹ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <div class="tab-content" id="tab-settings">
            <div class="section">
                <h2>BOSSè³‡è¨Šä¸€è¦½</h2>
                <div style="overflow-x: auto;">
                    <table id="boss-list-table">
                        <thead>
                            <tr>
                                <th style="width: 60px;">åœ–ç‰‡</th>
                                <th>BOSSåç¨±</th>
                                <th>é‡ç”Ÿæ™‚é–“ç¯„åœ</th>
                                <th>åœ°åœ–</th>
                            </tr>
                        </thead>
                        <tbody id="boss-list-tbody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="tab-content" id="tab-statistics">
            <div class="section">
                <div class="stats-header">
                    <h2>ğŸ“Š BOSSæ“Šæ®ºçµ±è¨ˆ</h2>
                    <div class="button-group" style="margin: 0;">
                        <button onclick="resetTodayStats()">ğŸ”„ é‡ç½®ä»Šæ—¥çµ±è¨ˆ</button>
                        <button onclick="resetAllStats()" class="danger">âš ï¸ æ¸…ç©ºæ‰€æœ‰çµ±è¨ˆ</button>
                    </div>
                </div>
                
                <div class="info-box">
                    <p>ğŸ“… çµ±è¨ˆæ—¥æœŸ: <span id="stats-date"></span></p>
                    <p>ğŸ¯ ä»Šæ—¥ç¸½æ“Šæ®º: <span id="total-today-kills" style="color: #ff9800; font-weight: bold; font-size: 1.2em;">0</span> æ¬¡</p>
                    <p>ğŸ† ç´¯ç©ç¸½æ“Šæ®º: <span id="total-all-kills" style="color: #00ff99; font-weight: bold; font-size: 1.2em;">0</span> æ¬¡</p>
                </div>

                <div class="stats-grid" id="stats-grid">
                    <!-- çµ±è¨ˆå¡ç‰‡å°‡åœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <div class="tab-content" id="tab-feedback">
            <div class="section">
                <h2>ğŸ’¡ æ”¹å–„å»ºè­°</h2>
                <p style="color: #a0a0c0; margin-bottom: 20px;">
                    å¦‚æœæ‚¨åœ¨ä½¿ç”¨éç¨‹ä¸­æœ‰ä»»ä½•æ”¹å–„å»ºè­°æˆ–ç™¼ç¾å•é¡Œï¼Œæ­¡è¿é€éä¸‹æ–¹è¡¨å–®å‘Šè¨´æˆ‘å€‘ï¼
                </p>
                
                <div class="input-group">
                    <div class="input-field" style="grid-column: 1 / -1;">
                        <label>å»ºè­°é¡å‹:</label>
                        <select id="feedback-type" style="width: 100%;">
                            <option value="åŠŸèƒ½å»ºè­°">åŠŸèƒ½å»ºè­°</option>
                            <option value="éŒ¯èª¤å›å ±">éŒ¯èª¤å›å ±</option>
                            <option value="UI/UXæ”¹å–„">UI/UXæ”¹å–„</option>
                            <option value="å…¶ä»–">å…¶ä»–</option>
                        </select>
                    </div>
                </div>

                <div class="input-group">
                    <div class="input-field" style="grid-column: 1 / -1;">
                        <label>è©³ç´°èªªæ˜:</label>
                        <textarea id="feedback-content" 
                                  style="width: 100%; min-height: 150px; padding: 10px; 
                                         background: #0a0a1a; border: 1px solid #00ccff; 
                                         border-radius: 5px; color: #ffffff; font-family: inherit; 
                                         font-size: 1em; resize: vertical;"
                                  placeholder="è«‹è©³ç´°æè¿°æ‚¨çš„å»ºè­°æˆ–å•é¡Œ..."></textarea>
                    </div>
                </div>

                <div class="input-group">
                    <div class="input-field">
                        <label>è¯çµ¡æ–¹å¼ (é¸å¡«):</label>
                        <input type="text" id="feedback-contact" 
                               placeholder="Emailã€éŠæˆ²ID æˆ–å…¶ä»–è¯çµ¡æ–¹å¼"
                               style="width: 100%;">
                    </div>
                </div>

                <div class="button-group">
                    <button onclick="submitFeedback()" style="padding: 15px 30px; font-size: 1.1em;">
                        ğŸ“¨ æäº¤å»ºè­°
                    </button>
                    <button onclick="clearFeedbackForm()" class="danger">
                        ğŸ”„ æ¸…ç©ºè¡¨å–®
                    </button>
                </div>

                <div class="info-box" style="margin-top: 20px;">
                    <p style="color: #00ff99; font-size: 0.9em;">
                        â„¹ï¸ æ‚¨çš„å»ºè­°å°‡æœƒé€é”é–‹ç™¼åœ˜éšŠï¼Œæˆ‘å€‘æœƒä»”ç´°é–±è®€æ¯ä¸€æ¢å»ºè­°ä¸¦æŒçºŒæ”¹é€²ç³»çµ±ã€‚æ„Ÿè¬æ‚¨çš„æ”¯æŒï¼
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script src="discord-notifications.js"></script>
    <script>
        // BOSS æ•¸æ“š
        const BOSS_DATA = {
            "ç´…å¯¶ç‹": { min: 23, max: 30, maps: ["æµ·å²¸è‰å¢3"], color: "#ff4444", image: "images/ç´…å¯¶ç‹.gif" },
            "æ¨¹å¦–ç‹": { min: 23, max: 30, maps: ["æ±æ–¹å²©çŸ³å±±5"], color: "#8bc34a", image: "images/æ¨¹å¦–ç‹.gif" },
            "å†¥ç•Œå¹½éˆ": { min: 45, max: 60, maps: ["1è™Ÿç·š<4å€>", "2è™Ÿç·š<3å€>"], color: "#9c27b0", image: "images/å†¥ç•Œå¹½éˆ.gif" },
            "å·¨å±…èŸ¹": { min: 45, max: 60, maps: ["æµ·é¾œæ²™ç˜"], color: "#ff9800", image: "images/å·¨å±…èŸ¹.gif" },
            "æ®­å±çŒ´ç‹": { min: 38, max: 45, maps: ["å·«å©†æ£®æ—1"], color: "#795548", image: "images/æ®­å±çŒ´ç‹.gif" },
            "è˜‘è‡ç‹": { min: 210, max: 240, maps: ["é‹¼ä¹‹è‚¥è‚¥å…¬åœ’3"], color: "#ff5722", image: "images/è˜‘è‡ç‹.gif" },
            "æ²¼æ¾¤å·¨é±·": { min: 90, max: 105, maps: ["å±éšªçš„é»‘é±·é­š1"], color: "#4caf50", image: "images/æ²¼æ¾¤å·¨é±·.gif" },
            "æ®­å±è˜‘è‡ç‹": { min: 195, max: 225, maps: ["è˜‘è‡ç‹ä¹‹å¢“"], color: "#e91e63", image: "images/æ®­å±è˜‘è‡ç‹.gif" },
            "å·´æ´›å¤": { min: 405, max: 540, maps: ["å—è©›å’’çš„ç¥æ®¿"], color: "#ff0000", image: "images/å·´æ´›å¤.gif" },
            "è‰¾åˆ©å‚‘": { min: 118, max: 128, maps: ["å¤©ç©ºéšæ¢¯2"], color: "#00bcd4", image: "images/è‰¾åˆ©å‚‘.gif" },
            "é›ªå±±å¥³å·«": { min: 158, max: 180, maps: ["å†°é¢1"], color: "#87ceeb", image: "images/é›ªå±±å¥³å·«.gif" },
            "é›ªæ¯›æ€ªäºº": { min: 45, max: 68, maps: ["é›ªäººä¹‹è°·"], color: "#f0f8ff", image: "images/é›ªæ¯›æ€ªäºº.gif" },
            "å„é‹æ­»ç¥": { min: 45, max: 105, maps: ["æ­»äº¡æ£®æ—4"], color: "#2f4f4f", image: "images/å„é‹æ­»ç¥.gif" },
            "å’•å’•é˜": { min: 68, max: 90, maps: ["æ™‚é–“ä¹‹è·¯<3>"], color: "#daa520", image: "images/å’•å’•é˜.gif" },
            "è‘›é›·é‡‘å‰›": { min: 270, max: 350, maps: ["è‘›é›·è‰åŸ"], color: "#8b4513", image: "images/è‘›é›·é‡‘å‰›.gif" },
            "æ›¸ç”Ÿå¹½éˆ": { min: 150, max: 300, maps: ["ç‹ç‹¸è°·"], color: "#9370db", image: "images/æ›¸ç”Ÿå¹½éˆ.gif" },
            "ä¹å°¾å¦–ç‹": { min: 210, max: 570, maps: ["æœˆäº®å±±å¡"], color: "#ff69b4", image: "images/ä¹å°¾å¦–ç‹.gif" },
            "é»‘è¼ªç‹": { min: 780, max: 1020, maps: ["å¤œå¸‚å¾’æ­¥å€7", "å¤œå¸‚å¾’æ­¥å€7-1"], color: "#000000", hasMapSelect: true, image: "images/é»‘è¼ªç‹.gif" },
            "ç˜‹ç‹‚å–µzå®¢": { min: 120, max: 420, maps: ["åäººå¤§é“è¥¿éƒ¨å€åŸŸ"], color: "#ffa500", image: "images/ç˜‹ç‹‚å–µzå®¢.gif" },
            "ä»™äººå¨ƒå¨ƒ": { min: 158, max: 180, maps: ["ä¸Šç´šè¨“ç·´å ´"], color: "#98fb98", image: "images/ä»™äººå¨ƒå¨ƒ.gif" },
            "è‚¯å¾·ç†Š": { min: 113, max: 128, maps: ["æµæµªç†Šçš„é ˜åœŸ"], color: "#8b7355", image: "images/è‚¯å¾·ç†Š.gif" },
            "å–µæ€ªä»™äºº": { min: 150, max: 170, maps: ["å–µæ€ªä»™äººçš„é ˜åŸŸ"], color: "#ffb6c1", image: "images/å–µæ€ªä»™äºº.gif" },
            "å·¨å¤§æ·±å±±äººè”˜": { min: 60, max: 135, maps: ["è±é¥’çš„è—¥è‰ç”°"], color: "#ffd700", image: "images/å·¨å¤§æ·±å±±äººè”˜.gif" },
            "æµ·æ€’æ–¯": { min: 180, max: 300, maps: ["æµ·æ€’æ–¯æ´ç©´"], color: "#1e90ff", image: "images/æµ·æ€’æ–¯.gif" }
        };

        // å­˜å„²æ•¸æ“š
        let activeBosses = [];
        let patrolRecords = [];
        let bossStatistics = {}; // æ–°å¢ï¼šBOSSçµ±è¨ˆæ•¸æ“š

        // åˆå§‹åŒ–
        function init() {
            loadData();
            populateBossSelect();
            populateBossListTable();
            initializeStatistics();
            updateAllDisplays();
            setInterval(updateAllDisplays, 1000); // æ¯ç§’æ›´æ–°ä¸€æ¬¡ä»¥æ”¯æŒå€’æ•¸è¨ˆæ™‚

            // æ·»åŠ Enteréµç›£è½
            document.getElementById('channel-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    recordBoss();
                }
            });
        }

        // åˆå§‹åŒ–çµ±è¨ˆæ•¸æ“š
        function initializeStatistics() {
            // ç¢ºä¿æ¯å€‹BOSSéƒ½æœ‰çµ±è¨ˆæ•¸æ“š
            Object.keys(BOSS_DATA).forEach(bossName => {
                if (!bossStatistics[bossName]) {
                    bossStatistics[bossName] = {
                        totalKills: 0,
                        todayKills: 0,
                        lastResetDate: getTodayDateString()
                    };
                }
            });
        }

        // ç²å–ä»Šå¤©çš„æ—¥æœŸå­—ä¸² (YYYY-MM-DD)
        function getTodayDateString() {
            const now = new Date();
            return now.toISOString().split('T')[0];
        }

        // æª¢æŸ¥ä¸¦é‡ç½®æ¯æ—¥çµ±è¨ˆ
        function checkAndResetDailyStats() {
            const today = getTodayDateString();
            let needsReset = false;

            Object.keys(bossStatistics).forEach(bossName => {
                if (bossStatistics[bossName].lastResetDate !== today) {
                    bossStatistics[bossName].todayKills = 0;
                    bossStatistics[bossName].lastResetDate = today;
                    needsReset = true;
                }
            });

            if (needsReset) {
                saveData();
            }
        }

        // æ›´æ–°BOSSçµ±è¨ˆ
        function updateBossStatistics(bossName) {
            if (!bossStatistics[bossName]) {
                bossStatistics[bossName] = {
                    totalKills: 0,
                    todayKills: 0,
                    lastResetDate: getTodayDateString()
                };
            }

            const today = getTodayDateString();
            if (bossStatistics[bossName].lastResetDate !== today) {
                bossStatistics[bossName].todayKills = 0;
                bossStatistics[bossName].lastResetDate = today;
            }

            bossStatistics[bossName].totalKills++;
            bossStatistics[bossName].todayKills++;
            
            saveData();
        }

        // æ›´æ–°çµ±è¨ˆé¡¯ç¤º
        function updateStatisticsDisplay() {
            const statsGrid = document.getElementById('stats-grid');
            const today = getTodayDateString();
            
            // æ›´æ–°æ—¥æœŸå’Œç¸½è¨ˆ
            document.getElementById('stats-date').textContent = new Date().toLocaleDateString('zh-TW');
            
            let totalToday = 0;
            let totalAll = 0;

            // ç”Ÿæˆçµ±è¨ˆå¡ç‰‡
            let html = '';
            Object.entries(BOSS_DATA).forEach(([bossName, info]) => {
                const stats = bossStatistics[bossName] || { totalKills: 0, todayKills: 0 };
                
                totalToday += stats.todayKills;
                totalAll += stats.totalKills;

                const bossImageHtml = info.image ? `<img src="${info.image}" alt="${bossName}" class="stats-card-image">` : `<span style="color: ${info.color}">â—</span>`;

                html += `
                    <div class="stats-card">
                        <h3 style="display: flex; align-items: center;">
                            ${bossImageHtml}
                            ${bossName}
                        </h3>
                        <div>
                            <p class="stats-label">ä»Šæ—¥æ“Šæ®º</p>
                            <p class="stats-number stats-today">${stats.todayKills}</p>
                        </div>
                        <div>
                            <p class="stats-label">ç´¯ç©æ“Šæ®º</p>
                            <p class="stats-number stats-total">${stats.totalKills}</p>
                        </div>
                    </div>
                `;
            });

            statsGrid.innerHTML = html;
            
            // æ›´æ–°ç¸½è¨ˆ
            document.getElementById('total-today-kills').textContent = totalToday;
            document.getElementById('total-all-kills').textContent = totalAll;
        }

        // é‡ç½®ä»Šæ—¥çµ±è¨ˆ
        function resetTodayStats() {
            if (confirm('ç¢ºå®šè¦é‡ç½®ä»Šæ—¥æ‰€æœ‰BOSSçš„æ“Šæ®ºçµ±è¨ˆå—ï¼Ÿ')) {
                const today = getTodayDateString();
                Object.keys(bossStatistics).forEach(bossName => {
                    bossStatistics[bossName].todayKills = 0;
                    bossStatistics[bossName].lastResetDate = today;
                });
                saveData();
                updateStatisticsDisplay();
                showNotification('å·²é‡ç½®ä»Šæ—¥çµ±è¨ˆ', 'success');
            }
        }

        // é‡ç½®æ‰€æœ‰çµ±è¨ˆ
        function resetAllStats() {
            if (confirm('ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰BOSSçš„æ“Šæ®ºçµ±è¨ˆå—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸï¼')) {
                const today = getTodayDateString();
                Object.keys(bossStatistics).forEach(bossName => {
                    bossStatistics[bossName].totalKills = 0;
                    bossStatistics[bossName].todayKills = 0;
                    bossStatistics[bossName].lastResetDate = today;
                });
                saveData();
                updateStatisticsDisplay();
                showNotification('å·²æ¸…ç©ºæ‰€æœ‰çµ±è¨ˆæ•¸æ“š', 'success');
            }
        }

        // å¡«å……BOSSé¸æ“‡åˆ—è¡¨
        function populateBossSelect() {
            const select = document.getElementById('boss-select');
            Object.keys(BOSS_DATA).forEach(boss => {
                const option = document.createElement('option');
                option.value = boss;
                option.textContent = boss;
                select.appendChild(option);
            });
        }

        // å¡«å……BOSSåˆ—è¡¨è¡¨æ ¼
        function populateBossListTable() {
            const tbody = document.getElementById('boss-list-tbody');
            tbody.innerHTML = '';
            Object.entries(BOSS_DATA).forEach(([name, info]) => {
                const row = tbody.insertRow();
                
                // åœ–ç‰‡åˆ—
                const imgCell = row.insertCell(0);
                if (info.image) {
                    imgCell.innerHTML = `<img src="${info.image}" alt="${name}" class="boss-list-image">`;
                }
                
                row.insertCell(1).textContent = name;
                row.insertCell(2).textContent = formatTimeRange(info.min, info.max);
                row.insertCell(3).textContent = info.maps.join(', ');
            });
        }

        // æ ¼å¼åŒ–æ™‚é–“ç¯„åœ
        function formatTimeRange(min, max) {
            const minHour = Math.floor(min/60);
            const minMin = min%60;
            const maxHour = Math.floor(max/60);
            const maxMin = max%60;
            
            let minStr, maxStr;
            
            // æ ¼å¼åŒ–æœ€å°æ™‚é–“
            if (minHour > 0) {
                minStr = minMin > 0 ? `${minHour}å°æ™‚${minMin}åˆ†` : `${minHour}å°æ™‚`;
            } else {
                minStr = `${minMin}åˆ†`;
            }
            
            // æ ¼å¼åŒ–æœ€å¤§æ™‚é–“
            if (maxHour > 0) {
                maxStr = maxMin > 0 ? `${maxHour}å°æ™‚${maxMin}åˆ†` : `${maxHour}å°æ™‚`;
            } else {
                maxStr = `${maxMin}åˆ†`;
            }
            
            return `${minStr} ~ ${maxStr}`;
        }

        // BOSSé¸æ“‡äº‹ä»¶
        function onBossSelected() {
            const bossName = document.getElementById('boss-select').value;
            const mapSelectContainer = document.getElementById('map-select-container');
            const previewImage = document.getElementById('boss-preview-image');
            
            if (bossName && BOSS_DATA[bossName]) {
                const info = BOSS_DATA[bossName];
                
                // æª¢æŸ¥æ˜¯å¦ç‚ºé»‘è¼ªç‹
                if (info.hasMapSelect) {
                    mapSelectContainer.style.display = 'block';
                } else {
                    mapSelectContainer.style.display = 'none';
                }
                
                // é¡¯ç¤ºBOSSåœ–ç‰‡
                if (info.image) {
                    previewImage.src = info.image;
                    previewImage.alt = bossName;
                    previewImage.style.display = 'block';
                } else {
                    previewImage.style.display = 'none';
                }
                
                document.getElementById('map-info').textContent = `åœ°åœ–: ${info.maps.join(', ')}`;
                document.getElementById('time-info').textContent = `é‡ç”Ÿæ™‚é–“: ${formatTimeRange(info.min, info.max)}`;
                document.getElementById('boss-info').style.display = 'block';
            } else {
                document.getElementById('boss-info').style.display = 'none';
                mapSelectContainer.style.display = 'none';
                previewImage.style.display = 'none';
            }
        }

        // è¨˜éŒ„BOSSæ“Šæ®º
        function recordBoss() {
            const bossName = document.getElementById('boss-select').value;
            const channel = document.getElementById('channel-input').value;
            const notification = true; // é»˜èªé–‹å•Ÿæé†’

            if (!bossName) {
                showNotification('è«‹é¸æ“‡BOSS', 'warning');
                return;
            }

            if (!channel) {
                showNotification('è«‹è¼¸å…¥é »é“', 'warning');
                return;
            }

            const info = BOSS_DATA[bossName];
            const now = new Date();
            const respawnMin = new Date(now.getTime() + info.min * 60000);
            const respawnMax = new Date(now.getTime() + info.max * 60000);

            // ç²å–åœ°åœ–ä¿¡æ¯
            let mapLocation = info.maps[0]; // é»˜èªç¬¬ä¸€å€‹åœ°åœ–
            if (info.hasMapSelect) {
                const selectedMap = document.getElementById('map-select').value;
                mapLocation = selectedMap === '7' ? 'å¤œå¸‚å¾’æ­¥å€7' : 'å¤œå¸‚å¾’æ­¥å€7-1';
            }

            // æª¢æŸ¥æ˜¯å¦å·²å­˜åœ¨ç›¸åŒBOSSå’Œé »é“çš„è¨˜éŒ„
            const existingRecordIndex = activeBosses.findIndex(
                b => b.bossName === bossName && b.channel === channel && b.map === mapLocation
            );

            if (existingRecordIndex !== -1) {
                // å¦‚æœå­˜åœ¨ï¼Œæ›´æ–°ç¾æœ‰è¨˜éŒ„
                const existingRecord = activeBosses[existingRecordIndex];
                existingRecord.deathTime = now.toISOString();
                existingRecord.respawnMin = respawnMin.toISOString();
                existingRecord.respawnMax = respawnMax.toISOString();
                existingRecord.notified = false;
                existingRecord.lastPatrolTime = null;
                
                // æ›´æ–°çµ±è¨ˆ
                updateBossStatistics(bossName);
                
                saveData();
                updateAllDisplays();

                // åœ¨å¾Œå°ç™¼é€Discordé€šçŸ¥ï¼ˆä¸é˜»å¡UIï¼‰
                if (typeof sendKillNotification === 'function') {
                    sendKillNotification(existingRecord).catch(err => {
                        // éœé»˜è™•ç†éŒ¯èª¤
                    });
                }

                showNotification(
                    `é »é“ ${channel} - ${bossName}\nåœ°åœ–: ${mapLocation}\nå·²æ›´æ–°æ“Šæ®ºæ™‚é–“ï¼\né è¨ˆé‡ç”Ÿ: ${formatTime(respawnMin)} ~ ${formatTime(respawnMax)}`,
                    'success'
                );
            } else {
                // å¦‚æœä¸å­˜åœ¨ï¼Œæ–°å¢è¨˜éŒ„
                const record = {
                    id: Date.now(),
                    channel: channel,
                    bossName: bossName,
                    map: mapLocation,
                    deathTime: now.toISOString(),
                    respawnMin: respawnMin.toISOString(),
                    respawnMax: respawnMax.toISOString(),
                    notified: false,
                    notificationEnabled: notification,
                    lastPatrolTime: null
                };

                activeBosses.push(record);
                
                // æ›´æ–°çµ±è¨ˆ
                updateBossStatistics(bossName);
                
                saveData();
                updateAllDisplays();

                // åœ¨å¾Œå°ç™¼é€Discordé€šçŸ¥ï¼ˆä¸é˜»å¡UIï¼‰
                if (typeof sendKillNotification === 'function') {
                    sendKillNotification(record).catch(err => {
                        // éœé»˜è™•ç†éŒ¯èª¤
                    });
                }

                showNotification(
                    `é »é“ ${channel} - ${bossName}\nåœ°åœ–: ${mapLocation}\næ“Šæ®ºæ™‚é–“å·²è¨˜éŒ„ï¼\né è¨ˆé‡ç”Ÿ: ${formatTime(respawnMin)} ~ ${formatTime(respawnMax)}`,
                    'success'
                );
            }

            // æ¸…ç©ºè¼¸å…¥
            document.getElementById('channel-input').value = '';
            document.getElementById('channel-input').focus();
        }

        // åˆªé™¤å–®å€‹è¨˜éŒ„
        function deleteRecord(id) {
            if (confirm('ç¢ºå®šè¦åˆªé™¤æ­¤è¨˜éŒ„å—ï¼Ÿ')) {
                activeBosses = activeBosses.filter(b => b.id !== id);
                saveData();
                updateAllDisplays();
                showNotification('å·²åˆªé™¤BOSSè¨˜éŒ„', 'success');
            }
        }

        // é‡æ–°è¨ˆæ™‚å–®å€‹BOSS
        function respawnSingleBoss(id) {
            const record = activeBosses.find(b => b.id === id);
            if (record) {
                const info = BOSS_DATA[record.bossName];
                const now = new Date();
                record.deathTime = now.toISOString();
                record.respawnMin = new Date(now.getTime() + info.min * 60000).toISOString();
                record.respawnMax = new Date(now.getTime() + info.max * 60000).toISOString();
                record.notified = false;
                
                // æ›´æ–°çµ±è¨ˆ
                updateBossStatistics(record.bossName);
                
                saveData();
                updateAllDisplays();
                
                // åœ¨å¾Œå°ç™¼é€Discordé€šçŸ¥ï¼ˆä¸é˜»å¡UIï¼‰
                if (typeof sendKillNotification === 'function') {
                    sendKillNotification(record).catch(err => {
                        // éœé»˜è™•ç†éŒ¯èª¤
                    });
                }
                
                showNotification(`å·²é‡æ–°è¨ˆæ™‚ ${record.bossName}ï¼`, 'success');
            }
        }

        // å·¡é‚æ‰“å¡å–®å€‹BOSS
        function patrolSingleBoss(id) {
            const record = activeBosses.find(b => b.id === id);
            if (record) {
                const now = new Date();
                record.lastPatrolTime = now.toISOString();
                
                patrolRecords.push({
                    timestamp: now.toISOString(),
                    bossName: record.bossName,
                    channel: record.channel,
                    map: record.map,
                    result: 'æœªé‡ç”Ÿ',
                    note: 'å¾BOSSè¨˜éŒ„å·¡é‚æ‰“å¡'
                });

                saveData();
                updateAllDisplays();
                showNotification(
                    `å·¡é‚æ‰“å¡è¨˜éŒ„å·²å„²å­˜ï¼\nBOSS: ${record.bossName}\né »é“: ${record.channel}\nåœ°åœ–: ${record.map}`,
                    'success'
                );
            }
        }

        // åˆªé™¤è¨˜éŒ„
        function deleteRecords() {
            const selected = getSelectedRecords();
            if (selected.length === 0) {
                showNotification('è«‹é¸æ“‡è¦åˆªé™¤çš„è¨˜éŒ„', 'warning');
                return;
            }

            if (confirm(`ç¢ºå®šè¦åˆªé™¤ ${selected.length} å€‹è¨˜éŒ„å—ï¼Ÿ`)) {
                activeBosses = activeBosses.filter(b => !selected.includes(b.id));
                saveData();
                updateAllDisplays();
                showNotification(`å·²åˆªé™¤ ${selected.length} å€‹BOSSè¨˜éŒ„`, 'success');
            }
        }

        // é‡æ–°è¨ˆæ™‚BOSS
        function respawnBoss() {
            const selected = getSelectedRecords();
            if (selected.length === 0) {
                showNotification('è«‹é¸æ“‡è¦é‡æ–°è¨ˆæ™‚çš„BOSSè¨˜éŒ„', 'warning');
                return;
            }

            selected.forEach(id => {
                const record = activeBosses.find(b => b.id === id);
                if (record) {
                    const info = BOSS_DATA[record.bossName];
                    const now = new Date();
                    record.deathTime = now.toISOString();
                    record.respawnMin = new Date(now.getTime() + info.min * 60000).toISOString();
                    record.respawnMax = new Date(now.getTime() + info.max * 60000).toISOString();
                    record.notified = false;
                    
                    // æ›´æ–°çµ±è¨ˆ
                    updateBossStatistics(record.bossName);
                    
                    // åœ¨å¾Œå°ç™¼é€Discordé€šçŸ¥ï¼ˆä¸é˜»å¡UIï¼‰
                    if (typeof sendKillNotification === 'function') {
                        sendKillNotification(record).catch(err => {
                            // éœé»˜è™•ç†éŒ¯èª¤
                        });
                    }
                }
            });

            saveData();
            updateAllDisplays();
            showNotification(`å·²é‡æ–°è¨ˆæ™‚ ${selected.length} å€‹BOSSï¼`, 'success');
        }

        // å·¡é‚æ‰“å¡
        function patrolBoss() {
            const selected = getSelectedRecords();
            if (selected.length === 0) {
                showNotification('è«‹é¸æ“‡è¦å·¡é‚æ‰“å¡çš„BOSSè¨˜éŒ„', 'warning');
                return;
            }

            const id = selected[0];
            const record = activeBosses.find(b => b.id === id);
            if (record) {
                const now = new Date();
                record.lastPatrolTime = now.toISOString();
                
                patrolRecords.push({
                    timestamp: now.toISOString(),
                    bossName: record.bossName,
                    channel: record.channel,
                    map: record.map,
                    result: 'æœªé‡ç”Ÿ',
                    note: 'å¾BOSSè¨˜éŒ„å·¡é‚æ‰“å¡'
                });

                saveData();
                updateAllDisplays();
                showNotification(
                    `å·¡é‚æ‰“å¡è¨˜éŒ„å·²å„²å­˜ï¼\nBOSS: ${record.bossName}\né »é“: ${record.channel}\nåœ°åœ–: ${record.map}\næ™‚é–“: ${formatTime(now)}`,
                    'success'
                );
            }
        }

        // æ¸…ç©ºæ‰€æœ‰è¨˜éŒ„
        function clearAll() {
            if (activeBosses.length === 0) {
                showNotification('ç›®å‰æ²’æœ‰è¨˜éŒ„', 'warning');
                return;
            }

            if (confirm('ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰BOSSè¨˜éŒ„å—ï¼Ÿ')) {
                activeBosses = [];
                saveData();
                updateAllDisplays();
                showNotification('å·²æ¸…ç©ºæ‰€æœ‰è¨˜éŒ„', 'success');
            }
        }

        // æäº¤å»ºè­°
        async function submitFeedback() {
            console.log('[DEBUG] submitFeedback å‡½æ•¸è¢«èª¿ç”¨');
            
            const type = document.getElementById('feedback-type').value;
            const content = document.getElementById('feedback-content').value.trim();
            const contact = document.getElementById('feedback-contact').value.trim();

            console.log('[DEBUG] è¡¨å–®æ•¸æ“š:', { type, content, contact });

            if (!content) {
                console.log('[DEBUG] å…§å®¹ç‚ºç©ºï¼Œé¡¯ç¤ºè­¦å‘Š');
                showNotification('è«‹å¡«å¯«è©³ç´°èªªæ˜', 'warning');
                return;
            }

            const FEEDBACK_WEBHOOK = 'https://discord.com/api/webhooks/1438760814466039910/iYegYu_LoPALQokZnyEjFJKuVXU9MxBHhMKvcQpZx0Ny3sKeVvUjmob0ozV5-BBHsxsj';

            const now = new Date();
            const month = now.getMonth() + 1;
            const day = now.getDate();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const formattedTime = `${month}/${day} ${hours}:${minutes}`;

            const embed = {
                title: 'ğŸ“ æ–°çš„æ”¹å–„å»ºè­°',
                color: 0x00ccff,
                fields: [
                    {
                        name: 'ğŸ“‹ å»ºè­°é¡å‹',
                        value: type,
                        inline: true
                    },
                    {
                        name: 'ğŸ•’ æäº¤æ™‚é–“',
                        value: formattedTime,
                        inline: true
                    },
                    {
                        name: 'ğŸ’¬ è©³ç´°èªªæ˜',
                        value: content.length > 1024 ? content.substring(0, 1021) + '...' : content,
                        inline: false
                    }
                ],
                timestamp: now.toISOString(),
                footer: {
                    text: 'æ¥“ä¹‹è°·BOSSé‡ç”Ÿæ™‚é–“ç³»çµ± - æ”¹å–„å»ºè­°'
                }
            };

            if (contact) {
                embed.fields.push({
                    name: 'ğŸ“§ è¯çµ¡æ–¹å¼',
                    value: contact,
                    inline: false
                });
            }

            console.log('[DEBUG] æº–å‚™ç™¼é€çš„ embed:', JSON.stringify(embed, null, 2));
            console.log('[DEBUG] Webhook URL:', FEEDBACK_WEBHOOK);

            try {
                console.log('[DEBUG] é–‹å§‹ç™¼é€è«‹æ±‚...');
                const response = await fetch(FEEDBACK_WEBHOOK, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        embeds: [embed]
                    })
                });

                console.log('[DEBUG] å›æ‡‰ç‹€æ…‹:', response.status, response.statusText);
                
                const responseText = await response.text();
                console.log('[DEBUG] å›æ‡‰å…§å®¹:', responseText);

                if (response.ok) {
                    console.log('[DEBUG] æäº¤æˆåŠŸï¼');
                    showNotification('æ„Ÿè¬æ‚¨çš„å»ºè­°ï¼å·²æˆåŠŸæäº¤ âœ¨', 'success');
                    clearFeedbackForm();
                } else {
                    console.error('[ERROR] æäº¤å¤±æ•— - ç‹€æ…‹ç¢¼:', response.status);
                    console.error('[ERROR] éŒ¯èª¤è¨Šæ¯:', responseText);
                    showNotification('æäº¤å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦', 'error');
                }
            } catch (error) {
                console.error('[ERROR] ç™¼ç”Ÿç•°å¸¸:', error);
                console.error('[ERROR] éŒ¯èª¤å †ç–Š:', error.stack);
                showNotification('æäº¤å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·š', 'error');
            }
        }

        // æ¸…ç©ºå»ºè­°è¡¨å–®
        function clearFeedbackForm() {
            document.getElementById('feedback-type').value = 'åŠŸèƒ½å»ºè­°';
            document.getElementById('feedback-content').value = '';
            document.getElementById('feedback-contact').value = '';
        }

        // ç²å–é¸ä¸­çš„è¨˜éŒ„ID
        function getSelectedRecords() {
            const checkboxes = document.querySelectorAll('.boss-checkbox:checked');
            return Array.from(checkboxes).map(cb => parseInt(cb.dataset.id));
        }

        // åˆ‡æ›å…¨é¸ï¼ˆå·²ç§»é™¤å…¨é¸æŒ‰éˆ•ï¼Œä¿ç•™å‡½æ•¸ä»¥é˜²å…¶ä»–åœ°æ–¹ä½¿ç”¨ï¼‰
        function toggleSelectAll() {
            // æ­¤åŠŸèƒ½å·²ç§»é™¤ï¼Œä¿ç•™ç©ºå‡½æ•¸ä»¥é˜²æ­¢éŒ¯èª¤
        }

        // æ›´æ–°æ‰€æœ‰é¡¯ç¤º
        function updateAllDisplays() {
            checkAndResetDailyStats(); // æª¢æŸ¥æ˜¯å¦éœ€è¦é‡ç½®æ¯æ—¥çµ±è¨ˆ
            updateRecordDisplay();
            updateStatisticsDisplay();
        }

        // æ›´æ–°è¨˜éŒ„é¡¯ç¤º
        function updateRecordDisplay() {
            const container = document.getElementById('record-container');
            const now = new Date();
            
            // æ›´æ–°BOSSè¨ˆæ•¸
            document.getElementById('boss-count').textContent = activeBosses.length;

            if (activeBosses.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #a0a0c0; padding: 40px 0;">ç›®å‰æ²’æœ‰è¨˜éŒ„ä¸­çš„BOSS</p>';
                return;
            }

            const sorted = [...activeBosses].sort((a, b) => 
                new Date(a.respawnMin) - new Date(b.respawnMin)
            );

            let html = '';
            sorted.forEach(record => {
                const respawnMin = new Date(record.respawnMin);
                const respawnMax = new Date(record.respawnMax);
                const bossInfo = BOSS_DATA[record.bossName];
                const bossColor = bossInfo ? bossInfo.color : '#0099cc';
                
                // è¨ˆç®—ç‹€æ…‹å’Œå€’æ•¸æ™‚é–“
                let statusText = '';
                let statusClass = '';
                let countdownText = '';
                let showRespawnBtn = false;
                let showPatrolBtn = false;
                
                if (now < respawnMin) {
                    statusText = 'å³å°‡é‡ç”Ÿ';
                    statusClass = 'waiting';
                    showRespawnBtn = false;
                    showPatrolBtn = false;
                    
                    // è¨ˆç®—å€’æ•¸æ™‚é–“
                    const totalSeconds = Math.floor((respawnMin - now) / 1000);
                    const hours = Math.floor(totalSeconds / 3600);
                    const minutes = Math.floor((totalSeconds % 3600) / 60);
                    const seconds = totalSeconds % 60;
                    countdownText = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                } else if (now >= respawnMin && now <= respawnMax) {
                    statusText = 'å¯èƒ½é‡ç”Ÿ';
                    statusClass = 'possible';
                    showRespawnBtn = true;
                    showPatrolBtn = true;
                    
                    // è¨ˆç®—çª—å£æœŸå‰©é¤˜æ™‚é–“
                    const totalSeconds = Math.floor((respawnMax - now) / 1000);
                    const hours = Math.floor(totalSeconds / 3600);
                    const minutes = Math.floor((totalSeconds % 3600) / 60);
                    const seconds = totalSeconds % 60;
                    countdownText = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                } else {
                    statusText = 'ç¢ºå®šé‡ç”Ÿ';
                    statusClass = 'confirmed';
                    showRespawnBtn = true;
                    showPatrolBtn = false;
                    
                    // è¨ˆç®—è¶…éæ™‚é–“
                    const diffMin = Math.floor((now - respawnMax) / 60000);
                    countdownText = `+${diffMin}åˆ†`;
                }

                const mapInfo = record.map ? ` | ${record.map}` : '';
                const killTime = formatDateTime(new Date(record.deathTime));
                
                // å·¡é‚æ™‚é–“è³‡è¨Š
                let patrolInfo = '';
                if (record.lastPatrolTime) {
                    const diff = Math.floor((now - new Date(record.lastPatrolTime)) / 60000);
                    patrolInfo = `
                        <div class="boss-info-item">
                            <span style="color: #64748b;">|</span>
                            <span>ğŸ‘€ å·¡é‚: ${diff}åˆ†é˜å‰</span>
                        </div>
                    `;
                }

                // æŒ‰éˆ•HTML
                const respawnBtnHtml = showRespawnBtn ? `<button class="boss-icon-btn" onclick="respawnSingleBoss(${record.id})" title="é‡æ–°è¨ˆæ™‚">ğŸ”„</button>` : '';
                const patrolBtnHtml = showPatrolBtn ? `<button class="boss-icon-btn" onclick="patrolSingleBoss(${record.id})" title="å·¡é‚æ‰“å¡">ğŸ‘€</button>` : '';

                // BOSSåœ–ç‰‡
                const bossImage = bossInfo && bossInfo.image ? `<img src="${bossInfo.image}" alt="${record.bossName}" class="boss-image">` : '';

                html += `
                    <div class="boss-status-card" style="--boss-color: ${bossColor};">
                        <div class="boss-card-header">
                            <div class="boss-info-left">
                                ${bossImage}
                                <div class="boss-name-section">
                                    <div class="boss-name-main">${record.bossName}</div>
                                    <div class="boss-info-row">
                                        <div class="boss-info-item">
                                            <span>é »é“ ${record.channel}${mapInfo}</span>
                                        </div>
                                        <div class="boss-info-item">
                                            <span style="color: #64748b;">|</span>
                                            <span>âš”ï¸ æ“Šæ®º: ${killTime}</span>
                                        </div>
                                        ${patrolInfo}
                                        <div class="boss-info-item">
                                            <span style="color: #64748b;">|</span>
                                            <span class="boss-status-badge ${statusClass}">${statusText}</span>
                                            <span style="font-family: 'Courier New', monospace; font-weight: 600;">${countdownText}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="boss-action-btns">
                                ${respawnBtnHtml}
                                ${patrolBtnHtml}
                                <button class="boss-icon-btn delete" onclick="deleteRecord(${record.id})" title="åˆªé™¤">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // ç²å–BOSSç‹€æ…‹
        function getStatus(record) {
            const now = new Date();
            const respawnMin = new Date(record.respawnMin);
            const respawnMax = new Date(record.respawnMax);

            if (now < respawnMin) {
                const diff = Math.floor((respawnMin - now) / 60000);
                return { text: `ç­‰å¾…ä¸­ (${diff}åˆ†)`, className: 'status-waiting' };
            } else if (now >= respawnMin && now <= respawnMax) {
                return { text: 'ğŸ”´ å¯èƒ½å·²é‡ç”Ÿï¼', className: 'status-possible' };
            } else {
                return { text: 'â° è‚¯å®šå·²é‡ç”Ÿï¼', className: 'status-definite' };
            }
        }

        // é¡¯ç¤ºé€šçŸ¥
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `<p style="white-space: pre-line;">${message}</p>`;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        // åˆ‡æ›æ¨™ç±¤
        function switchTab(index) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');

            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));

            tabs[index].classList.add('active');
            contents[index].classList.add('active');
        }

        // æ ¼å¼åŒ–æ™‚é–“
        function formatTime(date) {
            return date.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit', hour12: false });
        }

        function formatDateTime(date, withSeconds = false) {
            const options = { 
                month: '2-digit', 
                day: '2-digit', 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: false
            };
            if (withSeconds) {
                options.second = '2-digit';
            }
            return date.toLocaleString('zh-TW', options).replace(/\//g, '/');
        }

        // ä¿å­˜æ•¸æ“šåˆ°localStorage
        function saveData() {
            localStorage.setItem('activeBosses', JSON.stringify(activeBosses));
            localStorage.setItem('patrolRecords', JSON.stringify(patrolRecords));
            localStorage.setItem('bossStatistics', JSON.stringify(bossStatistics));
        }

        // è¼‰å…¥æ•¸æ“š
        function loadData() {
            const savedBosses = localStorage.getItem('activeBosses');
            const savedPatrols = localStorage.getItem('patrolRecords');
            const savedStatistics = localStorage.getItem('bossStatistics');

            if (savedBosses) {
                try {
                    activeBosses = JSON.parse(savedBosses);
                } catch (e) {
                    console.error('è¼‰å…¥BOSSæ•¸æ“šå¤±æ•—:', e);
                }
            }

            if (savedPatrols) {
                try {
                    patrolRecords = JSON.parse(savedPatrols);
                } catch (e) {
                    console.error('è¼‰å…¥å·¡é‚è¨˜éŒ„å¤±æ•—:', e);
                }
            }

            if (savedStatistics) {
                try {
                    bossStatistics = JSON.parse(savedStatistics);
                } catch (e) {
                    console.error('è¼‰å…¥çµ±è¨ˆæ•¸æ“šå¤±æ•—:', e);
                    bossStatistics = {};
                }
            }
        }

        // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
